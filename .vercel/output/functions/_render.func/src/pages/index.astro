---
import Layout from "@layouts/Layout.astro";
import ProgressBar from "@components/ProgressBar.astro";
import CtaButtons from "@components/CtaButtons.astro";

import "../styles/global.css";

// Busca dados de progresso da API
let progress = { totalMonthly: 0, goal: Number(import.meta.env.PUBLIC_GOAL_MONTHLY || 150), supporters: 0 };
try { 
  const r = await fetch(`${import.meta.env.SITE}/api/progresso`); 
  progress = await r.json(); 
} catch {
  // Fallback em caso de erro
  console.log('Erro ao buscar progresso, usando valores padr√£o');
}
---

<Layout>
  <!-- Hero Section -->
  <section class="py-16 px-4 text-center">
    <div class="max-w-4xl mx-auto">
      <h1 class="text-5xl md:text-6xl font-bold text-white mb-6">
        Compre local, construa futuro.
      </h1>
      <p class="text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto">
        Um site para comprar <strong class="text-emerald-400">direto de quem produz</strong> em Lumiar e Biorregi√£o.
      </p>
      <CtaButtons />
    </div>
  </section>

  <!-- Progress Bar -->
  <section class="py-8 px-4">
    <div class="max-w-4xl mx-auto">
      <ProgressBar total={progress.totalMonthly} goal={progress.goal} supporters={progress.supporters} />
    </div>
  </section>

  <!-- Como funciona -->
  <section class="py-16 px-4">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-8 text-center">
        Como funciona
      </h2>
      <div class="grid md:grid-cols-3 gap-8">
        <div class="text-center p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
          <div class="text-4xl mb-4">üíö</div>
          <h3 class="text-xl font-semibold text-white mb-3">Contribui√ß√£o livre</h3>
          <p class="text-gray-300">Qualquer valor mensal ajuda a manter a plataforma funcionando.</p>
        </div>
        <div class="text-center p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
          <div class="text-4xl mb-4">üéØ</div>
          <h3 class="text-xl font-semibold text-white mb-3">Meta base</h3>
          <p class="text-gray-300">R$150/m√™s para cobrir plataforma e dom√≠nio.</p>
        </div>
        <div class="text-center p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
          <div class="text-4xl mb-4">üì¢</div>
          <h3 class="text-xl font-semibold text-white mb-3">Acima disso</h3>
          <p class="text-gray-300">Investimos em divulga√ß√£o e publica√ß√£o de novas bancas.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Por que apoiar -->
  <section class="py-16 px-4 bg-gradient-to-r from-emerald-900/20 to-emerald-800/20">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-8">
        Por que apoiar o Mercado Biorregional Lumiar?
      </h2>
      <div class="grid md:grid-cols-2 gap-8 text-left">
        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-emerald-400">üå± Economia Local</h3>
          <p class="text-gray-300">Fortalecemos produtores locais e reduzimos a pegada de carbono dos alimentos.</p>
        </div>
        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-emerald-400">ü§ù Comunidade</h3>
          <p class="text-gray-300">Criamos conex√µes diretas entre quem produz e quem consome.</p>
        </div>
        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-emerald-400">üçÉ Sustentabilidade</h3>
          <p class="text-gray-300">Promovemos pr√°ticas agr√≠colas mais sustent√°veis e conscientes.</p>
        </div>
        <div class="space-y-4">
          <h3 class="text-xl font-semibold text-emerald-400">üí° Inova√ß√£o</h3>
          <p class="text-gray-300">Desenvolvemos tecnologia para facilitar o com√©rcio local.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Call to Action Final -->
  <section class="py-16 px-4 text-center">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-6">
        Pronto para fazer parte dessa mudan√ßa?
      </h2>
      <p class="text-xl text-gray-300 mb-8">
        Sua contribui√ß√£o, por menor que seja, j√° faz a diferen√ßa.
      </p>
      <CtaButtons />
    </div>
  </section>
</Layout>