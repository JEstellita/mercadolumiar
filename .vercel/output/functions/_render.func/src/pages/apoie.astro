---
import Layout from "@layouts/Layout.astro";
import ProgressBar from "@components/ProgressBar.astro";
import CtaButtons from "@components/CtaButtons.astro";

import "../styles/global.css";

// Busca dados de progresso da API
let progress = { totalMonthly: 0, goal: Number(import.meta.env.PUBLIC_GOAL_MONTHLY || 150), supporters: 0 };
try { 
  const r = await fetch(`${import.meta.env.SITE}/api/progresso`); 
  progress = await r.json(); 
} catch {
  console.log('Erro ao buscar progresso, usando valores padr√£o');
}
---

<Layout>
  <!-- Hero Section -->
  <section class="py-16 px-4 text-center">
    <div class="max-w-4xl mx-auto">
      <h1 class="text-4xl md:text-5xl font-bold text-white mb-6">
        Apoie o Mercado Biorregional Lumiar
      </h1>
      <p class="text-xl text-gray-300 mb-8 max-w-3xl mx-auto">
        Sua contribui√ß√£o mensal ajuda a construir uma plataforma que conecta produtores locais com consumidores conscientes.
      </p>
    </div>
  </section>

  <!-- Progress Bar -->
  <section class="py-8 px-4">
    <div class="max-w-4xl mx-auto">
      <ProgressBar total={progress.totalMonthly} goal={progress.goal} supporters={progress.supporters} />
    </div>
  </section>

  <!-- Explica√ß√£o detalhada -->
  <section class="py-16 px-4">
    <div class="max-w-4xl mx-auto">
      <div class="grid md:grid-cols-2 gap-12">
        <div>
          <h2 class="text-3xl font-bold text-white mb-6">Como funciona o apoio</h2>
          <div class="space-y-6">
            <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
              <h3 class="text-xl font-semibold text-emerald-400 mb-3">üíö Contribui√ß√£o livre</h3>
              <p class="text-gray-300">A contribui√ß√£o mensal pode ser de qualquer valor. Cada real conta e faz a diferen√ßa para manter a plataforma funcionando.</p>
            </div>
            <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
              <h3 class="text-xl font-semibold text-emerald-400 mb-3">üéØ Meta base: R$150/m√™s</h3>
              <p class="text-gray-300">Este valor cobre os custos essenciais da plataforma: hospedagem, dom√≠nio e manuten√ß√£o b√°sica.</p>
            </div>
            <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
              <h3 class="text-xl font-semibold text-emerald-400 mb-3">üì¢ Acima da meta</h3>
              <p class="text-gray-300">Investimos em divulga√ß√£o, fotos dos produtos, materiais promocionais e publica√ß√£o de novas bancas com mais agilidade.</p>
            </div>
          </div>
        </div>
        
        <div>
          <h2 class="text-3xl font-bold text-white mb-6">Por que apoiar?</h2>
          <div class="space-y-6">
            <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
              <h3 class="text-xl font-semibold text-emerald-400 mb-3">üå± Economia Local</h3>
              <p class="text-gray-300">Fortalecemos produtores locais, reduzimos a pegada de carbono e promovemos alimentos mais frescos e saud√°veis.</p>
            </div>
            <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
              <h3 class="text-xl font-semibold text-emerald-400 mb-3">ü§ù Comunidade</h3>
              <p class="text-gray-300">Criamos conex√µes diretas entre quem produz e quem consome, fortalecendo os la√ßos da comunidade.</p>
            </div>
            <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
              <h3 class="text-xl font-semibold text-emerald-400 mb-3">üí° Tecnologia</h3>
              <p class="text-gray-300">Desenvolvemos ferramentas digitais que facilitam o com√©rcio local e tornam mais f√°cil encontrar produtos regionais.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="py-16 px-4 bg-gradient-to-r from-emerald-900/20 to-emerald-800/20">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-3xl font-bold text-white mb-8 text-center">
        Perguntas Frequentes
      </h2>
      <div class="space-y-6">
        <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
          <h3 class="text-xl font-semibold text-white mb-3">Como funciona o pagamento?</h3>
          <p class="text-gray-300">O pagamento √© feito atrav√©s do Mercado Pago, de forma segura e recorrente. Voc√™ pode cancelar a qualquer momento.</p>
        </div>
        <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
          <h3 class="text-xl font-semibold text-white mb-3">Posso mudar o valor da contribui√ß√£o?</h3>
          <p class="text-gray-300">Sim! Voc√™ pode alterar o valor da sua contribui√ß√£o mensal a qualquer momento atrav√©s do painel do Mercado Pago.</p>
        </div>
        <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
          <h3 class="text-xl font-semibold text-white mb-3">Como sei que meu dinheiro est√° sendo usado corretamente?</h3>
          <p class="text-gray-300">Mantemos transpar√™ncia total atrav√©s desta p√°gina de progresso e relat√≥rios mensais sobre como os recursos s√£o utilizados.</p>
        </div>
        <div class="p-6 rounded-2xl bg-white/5 backdrop-blur-sm border">
          <h3 class="text-xl font-semibold text-white mb-3">O que acontece se n√£o atingirmos a meta?</h3>
          <p class="text-gray-300">Mesmo sem atingir a meta, continuamos trabalhando na plataforma. Cada contribui√ß√£o ajuda a manter o projeto vivo e crescendo.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Call to Action -->
  <section class="py-16 px-4 text-center">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-3xl font-bold text-white mb-6">
        Pronto para fazer parte dessa mudan√ßa?
      </h2>
      <p class="text-xl text-gray-300 mb-8">
        Se fizer sentido, seu apoio ‚Äî do tamanho que for ‚Äî j√° ajuda muito. E se puder, encaminhe para duas pessoas que valorizam comprar local.
      </p>
      <CtaButtons />
    </div>
  </section>
</Layout>
