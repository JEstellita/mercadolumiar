---
const { total = 0, goal = 150, supporters = 0, stale = false } = Astro.props;
const pct = Math.min(100, Math.round((total/goal)*100));
---
<div 
  class="progress-container"
  data-total={total}
  data-goal={goal}
  data-supporters={supporters}
>
  <!-- Progress header -->
  <div class="progress-header">
    <div>
      <h3 style="font-size: 1.5rem; font-weight: 700; color: #1f2937; margin-bottom: 0.5rem;">Meta da Campanha</h3>
      <p style="color: #6b7280;">Vamos juntos até R$ {goal}/mês</p>
    </div>
    <div style="text-align: right;">
      <div style="font-size: 1.875rem; font-weight: 700; color: #16a34a;">{pct}%</div>
      <div style="font-size: 0.875rem; color: #9ca3af;">concluído</div>
    </div>
  </div>

  <!-- Progress bar -->
  <div class="progress-bar">
    <div 
      class="progress-fill"
      style={`width: ${pct}%`}
    ></div>
  </div>

  <!-- Progress stats -->
  <div class="progress-stats">
    <div class="stat">
      <div class="stat-value">
        R$ {total.toFixed(2)}
      </div>
      <div class="stat-label">arrecadado</div>
    </div>
    
    <div class="stat">
      <div class="stat-value">
        R$ {goal}
      </div>
      <div class="stat-label">meta mensal</div>
    </div>
    
    <div class="stat">
      <div class="stat-value">
        {supporters}
      </div>
      <div class="stat-label">apoiadores</div>
    </div>
  </div>

  {stale && (
    <div style="margin-top: 1rem; display: flex; align-items: center; justify-content: center; font-size: 0.875rem; color: #9ca3af;">
      <svg style="animation: spin 1s linear infinite; width: 1rem; height: 1rem; margin-right: 0.5rem;" fill="none" viewBox="0 0 24 24">
        <circle style="opacity: 0.25;" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path style="opacity: 0.75;" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      Atualizando dados...
    </div>
  )}
</div>

<style>
  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }
</style>